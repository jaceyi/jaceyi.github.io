<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="keywords"
    content="jaceyi,yijinchun,Jace,JaceYi,Jace Yi,æ˜“è¿›æ˜¥,æ˜“è¿›æ˜¥çš„åšå®¢,yiä¸ªç¨‹åºçŒ¿,å‰ç«¯,å‰ç«¯å¼€å‘,å‰ç«¯åšå®¢,JavaScript">
  <meta name="description" content="æ˜“è¿›æ˜¥çš„ä¸ªäººåšå®¢ï¼Œåˆ†äº«æ—¥å¸¸ç”Ÿæ´»ã€å­¦ä¹ ç¬”è®°å’Œè¸©è¿‡çš„é‚£äº›å‘~" />
  <title>JSå‡½æ•°å¼ç¼–ç¨‹&é«˜é˜¶å‡½æ•°çš„åº”ç”¨ - æ˜“è¿›æ˜¥çš„åšå®¢</title>
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="stylesheet" href="/css/prism.css">
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/post.css">
  <script src="/js/util.js"></script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4613132254509352"
    crossorigin="anonymous"></script>
</head>

<body>
  <div id="header" style="background-image: url(/static/images/bg4.jpg)">
    <div class="bar">
  <div class="title">
    <a href="/">Jace's Blog</a>
  </div>
  <nav class="nav">
    <div class="item">
      <a href="/">Home</a>
    </div>
    <div class="item">
      <a href="/tags">Tags</a>
    </div>
    <div class="item">
      <a href="/about">About</a>
    </div>
  </nav>
  <div class="mobile-nav">
    <div class="mobile-nav-menu icon">
      <i class="iconfont">&#xe633;</i>
    </div>
    <div class="mobile-nav-box">
      <a href="/">Home</a>
      <a href="/tags">Tags</a>
      <a href="/about">About</a>
    </div>
  </div>
</div>

<script>
  (function (d, w) {
    w.onload = function () {
      var $menuIcon = d.querySelector('.mobile-nav-menu');
      var $navBox = d.querySelector('.mobile-nav-box');
      var animationEndCallback = null;
      function hideNavBox() {
        addClass($navBox, 'zoomOut');
        animationEndCallback = function () {
          removeClass($navBox, 'zoomOut');
          $navBox.style.display = 'none';
        }
      }

      $menuIcon.onclick = function (e) {
        e.stopPropagation();
        if ($navBox.style.display === 'block') return hideNavBox();
        $navBox.style.display = 'block';
        addClass($navBox, 'zoomIn');
        animationEndCallback = function () {
          removeClass($navBox, 'zoomIn');
        }
      };

      $navBox.onclick = function (e) {
        e.stopPropagation();
      };

      $navBox.addEventListener('animationend', function (e) {
        animationEndCallback && animationEndCallback();
      }, false);

      d.body.addEventListener('click', function () {
        if ($navBox.style.display === 'block') hideNavBox();
      }, false);

      var $header = d.querySelector('#header');
      var $bar = d.querySelector('.bar');
      var barHeight = $bar.offsetHeight;
      var prev = 0;
      w.addEventListener('scroll', function (e) {
        var scrollTop = d.documentElement.scrollTop || d.body.scrollTop;
        var step = $header.className.indexOf('visible') >= 0 ? barHeight : 0;
        if (scrollTop > $header.offsetHeight - step) {
          addClass($header, 'active');

          if (scrollTop > prev) {
            removeClass($header, 'visible');
          } else {
            addClass($header, 'visible');
          }
        } else {
          removeClass($header, ['active', 'visible']);
        }
        prev = scrollTop;
      }, false);
    }
  })(document, window);
</script>

    <div class="content">
      <h1 class="post-title">JSå‡½æ•°å¼ç¼–ç¨‹&é«˜é˜¶å‡½æ•°çš„åº”ç”¨</h1>
      <div class="post-description">æœ¬ç¯‡è®²è¿°ä½•ä¸ºå‡½æ•°å¼ç¼–ç¨‹ä»¥åŠé«˜é˜¶å‡½æ•°çš„åº”ç”¨ï¼Œç†Ÿç»ƒåœ°ä½¿ç”¨é«˜é˜¶å‡½æ•°èƒ½å¤§å¹…çš„æé«˜å¼€å‘æ•ˆç‡ã€å‡å°‘ä»£ç é‡ã€ä¼˜é›…å°è£…ã€‚</div>
      <div class="post-date">2020-07-05</div>
      <div class="tags">
        
        <a class="tag" href="/tags/#JavaScript" title="JavaScript">JavaScript</a>
        
      </div>
    </div>
  </div>

  <div class="container">
    <div class="main">
      <div class="article">
        <h2 id="å‰è¨€">å‰è¨€</h2>

<h3 id="å‡½æ•°æ˜¯-javascript-çš„ä¸€ç­‰å…¬æ°‘">å‡½æ•°æ˜¯ JavaScript çš„ä¸€ç­‰å…¬æ°‘</h3>

<!--more-->

<p>ç®€å•æä¸€ä¸‹ï¼Œä¸€ç­‰å…¬æ°‘éƒ½å…·å¤‡ä»¥ä¸‹ç‰¹æ€§ï¼š</p>

<ul>
  <li>å¯ä»¥è¢«å­˜å…¥å˜é‡æˆ–è€…å…¶ä»–æ•°æ®ç»“æ„</li>
  <li>å¯ä»¥ä½œä¸ºå‡½æ•°çš„å‚æ•°</li>
  <li>å¯ä»¥ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼</li>
  <li>å¯ä»¥åˆ¤æ–­ç›¸ç­‰æ€§</li>
</ul>

<p>å†™è¿‡ JS çš„äººè‚¯å®šéƒ½çŸ¥é“å‡½æ•°æ˜¯èƒ½æ»¡è¶³ä¸Šè¿°çš„ç‰¹æ€§ã€‚</p>

<blockquote>
  <p>å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå…¶ä¸­å‡½æ•°å®šä¹‰çš„æ˜¯è¡¨è¾¾å¼æ ‘ï¼Œæ¯ä¸ªè¡¨è¾¾å¼éƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œè€Œä¸æ˜¯æ”¹å˜ç¨‹åºçŠ¶æ€çš„å‘½ä»¤è¯­å¥ã€‚å› ä¸ºå‡½æ•°æ˜¯ JavaScript çš„ä¸€ç­‰å…¬æ°‘ï¼Œæ‰€ä»¥å¯ä»¥æŠŠå‡½æ•°ä½œä¸ºå…¶ä»–å‡½æ•°çš„å‚æ•°æˆ–è€…è¿”å›å€¼ï¼Œè¿™æ ·å°±å¯ä»¥å°†å…¶ä¸­å°åŠŸèƒ½ä»¥æ¨¡å—åŒ–çš„æ–¹å¼ç»„åˆåœ¨ä¸€èµ·ã€‚</p>
</blockquote>

<h2 id="çº¯å‡½æ•°">çº¯å‡½æ•°</h2>

<p>å¯ä»¥é€šè¿‡ç¦æ­¢æ›´æ”¹å¤–éƒ¨çŠ¶æ€å’Œæ•°æ®æ¥å®šä¹‰çº¯å‡½æ•°ï¼Œçº¯å‡½æ•°æ˜¯åªä¾èµ–å®é™…å‚æ•°ï¼Œä¸ç®¡ä»»ä½•å…¨å±€æˆ–è€…å±€éƒ¨çš„çŠ¶æ€ã€‚<strong>æ—¢è¾“å…¥ç›¸åŒçš„å‚æ•°ï¼Œè¾“å‡ºçš„å†…å®¹æ°¸è¿œéƒ½æ˜¯ä¸€æ ·çš„ã€‚</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">sum</span> <span class="o">=</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
<span class="nx">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">// 3</span>
</code></pre></div></div>

<p><strong>åŸç”Ÿä¾‹å­</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// [1]</span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// [1]</span>
<span class="nx">arr</span><span class="p">;</span> <span class="c1">// [1, 2, 3]</span>

<span class="nx">arr</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// [1]</span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// [2]</span>
<span class="nx">arr</span><span class="p">;</span> <span class="c1">// [3]</span>
</code></pre></div></div>

<p>ç”±ä¸Šå¯è§æ•°ç»„çš„ <code class="language-plaintext highlighter-rouge">slice</code> æ–¹æ³•æ˜¯çº¯å‡½æ•°ï¼Œä¸ä¼šæ”¹å˜åŸå¯¹è±¡ï¼›<code class="language-plaintext highlighter-rouge">splice</code> æ”¹å˜äº†åŸå¯¹è±¡ï¼Œå¯¼è‡´æ¯æ¬¡æ“ä½œè‡ªèº«éƒ½å‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥ä¸æ˜¯çº¯å‡½æ•°ã€‚</p>

<h3 id="çº¯å‡½æ•°çš„å¥½å¤„---memoize">çº¯å‡½æ•°çš„å¥½å¤„ - memoize</h3>

<blockquote>
  <p>ä½¿ç”¨çº¯å‡½æ•°æ—¶æˆ‘ä»¬å‘ç°ç¨‹åºå‡ºç°äº†ä¸é¢„æœŸä¸ç¬¦çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¾“å‡ºçš„å€¼ä¸æ˜¯æƒ³è¦å¾—å€¼ï¼Œé‚£ä¹ˆåªç”¨æ£€æŸ¥è¾“å…¥çš„å‚æ•°å°± OKã€‚</p>
</blockquote>

<p>ä¸Šé¢æåˆ°çº¯å‡½æ•°ï¼Œè¾“å…¥å€¼ä¸å˜ï¼Œé‚£ä¹ˆè¾“å‡ºå€¼ä¹Ÿä¼šä¸å˜ï¼Œè¿™é‡Œå°±å¯ä»¥å¯¹æ¯”è¾“å…¥çš„å‚æ•°æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œæ¥å†³å®šæ˜¯å¦è¦é‡æ–°æ¸²æŸ“æ¥å®ç°ä¸€ä¸ªç¼“å­˜ä¼˜åŒ–ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">memoize</span> <span class="o">=</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// ç¼“å­˜å‡½æ•°</span>
  <span class="kd">let</span> <span class="nx">cache</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="k">return</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// è¿™é‡Œä¸ºäº†æ–¹ä¾¿ å°±åªæ¥æ”¶ä¸€ä¸ªå‚æ•°äº†</span>
    <span class="kd">const</span> <span class="nx">prevValue</span> <span class="o">=</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">a</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">prevValue</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`cache </span><span class="p">${</span><span class="nx">prevValue</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">prevValue</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">cache</span><span class="p">[</span><span class="nx">a</span><span class="p">]</span> <span class="o">=</span> <span class="nx">f</span><span class="p">(</span><span class="nx">a</span><span class="p">));</span> <span class="c1">// ç¼“å­˜çº¯å‡½æ•°çš„å€¼</span>
  <span class="p">};</span>
<span class="p">};</span>
<span class="kd">const</span> <span class="nx">double</span> <span class="o">=</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// è¿ç®—å‡½æ•°ï¼ˆçº¯å‡½æ•°ï¼‰</span>
<span class="kd">const</span> <span class="nx">f</span> <span class="o">=</span> <span class="nx">memoize</span><span class="p">(</span><span class="nx">double</span><span class="p">);</span>

<span class="nx">f</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="c1">// 4</span>
<span class="nx">f</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="c1">// cache 4</span>

<span class="nx">f</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span> <span class="c1">// 16</span>
<span class="nx">f</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span> <span class="c1">// cache 16</span>
</code></pre></div></div>

<h2 id="æŸ¯é‡ŒåŒ–-curry">æŸ¯é‡ŒåŒ– Curry</h2>

<p>æŸ¯é‡ŒåŒ–æ˜¯æŠŠæ¥æ”¶å¤šä¸ªå‚æ•°çš„å‡½æ•°å˜æˆæ¥æ”¶å•ä¸€å‚æ•°çš„å‡½æ•°ï¼Œå‰©ä¸‹çš„å‚æ•°å†é€šè¿‡è¿”å›çš„å‡½æ•°æ¥è¿›è¡Œæ¥æ”¶ã€‚
ç®€å•ç†è§£å°±æ˜¯æŠŠå‡½æ•°æ‹†çš„æ›´ç»†ï¼Œè¿”å›çš„å‡½æ•°ä¾èµ–ç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œè®¡ç®—ï¼Œå¯ä»¥ç¼©å°é€‚ç”¨èŒƒå›´ï¼Œåˆ›å»ºä¸€ä¸ªé’ˆå¯¹æ€§æ›´å¼ºçš„å‡½æ•°ã€‚</p>

<ul>
  <li>å¯ä»¥å°†ä¸Šè¿°æ±‚å’Œçº¯å‡½æ•°æ”¹æˆä¸‹é¢çš„å†™æ³•</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">sum</span> <span class="o">=</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
<span class="nx">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">2</span><span class="p">);</span> <span class="c1">// 3</span>
</code></pre></div></div>

<p>å°† <code class="language-plaintext highlighter-rouge">sum</code> å‡½æ•°è½¬ä¸ºåªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå†æ¬¡è°ƒç”¨å°†å¾—åˆ°ç»“æœã€‚
æˆ–è®¸æœ‰äººè§‰å¾—è¿™æ ·å†™çº¯å±è›‹ç–¼ï¼Œé‚£ä¹ˆå°±ä¸¾ä¸€ä¸ªä¸šåŠ¡ä¸­ä¼šç”¨åˆ°çš„ä¸€ä¸ªä¾‹å­ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯ä»¥å°†é‡‘é¢è½¬ä¸ºåƒåˆ†ä½çš„å‡½æ•°ï¼Œä½†æ˜¯é‡‘é¢çš„å•ä½ä¸å®šï¼Œæœ‰å¯èƒ½æ˜¯åˆ†ï¼Œæœ‰å¯èƒ½æ˜¯è§’ç­‰ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">formatMoney</span> <span class="o">=</span> <span class="p">(</span><span class="nx">money</span><span class="p">,</span> <span class="nx">step</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">str</span> <span class="o">=</span> <span class="p">(</span><span class="nx">money</span> <span class="o">/</span> <span class="nx">step</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="c1">// ä¸¤ä½å°æ•°</span>
  <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">.</span><span class="dl">"</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">index</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">\B(?=(?:\d{3})</span><span class="sr">+$</span><span class="se">)</span><span class="sr">/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// å¢åŠ åƒåˆ†ä½ç¬¦å·</span>
    <span class="k">return</span> <span class="nx">start</span> <span class="o">+</span> <span class="nx">str</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">formatMoney</span><span class="p">(</span><span class="mi">1000000</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span> <span class="c1">// åˆ† 10,000.00</span>
<span class="nx">formatMoney</span><span class="p">(</span><span class="mi">123456</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span> <span class="c1">// åˆ† 1,234.56</span>
<span class="nx">formatMoney</span><span class="p">(</span><span class="mi">123456</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="c1">// è§’ 12,345.60</span>
</code></pre></div></div>

<p>ä¼ å…¥ä¸¤ä¸ªå‚æ•° <code class="language-plaintext highlighter-rouge">(money, step)</code> é‡‘é¢å’Œå•ä½ï¼Œåœ¨å‡½æ•°ä¸­ä¾æ®å•ä½æ¥å®æ—¶é‡‘é¢ã€‚ä½†æ˜¯æ¯æ¬¡éƒ½è¦ä¼ å•ä½ï¼Œé€ æˆé‡å¤çš„ä»£ç ã€‚</p>

<p><strong>æˆ‘ä»¬å¯ä»¥å°†ä¸Šè¿°æ–¹æ³•è½¬ä¸ºæŸ¯é‡ŒåŒ–å‡½æ•°ï¼š</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">formatMoney</span> <span class="o">=</span> <span class="p">(</span><span class="nx">step</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">money</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">str</span> <span class="o">=</span> <span class="p">(</span><span class="nx">money</span> <span class="o">/</span> <span class="nx">step</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="c1">// ä¸¤ä½å°æ•°</span>
  <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">.</span><span class="dl">"</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">index</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">\B(?=(?:\d{3})</span><span class="sr">+$</span><span class="se">)</span><span class="sr">/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// å¢åŠ åƒåˆ†ä½ç¬¦å·</span>
    <span class="k">return</span> <span class="nx">start</span> <span class="o">+</span> <span class="nx">str</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">};</span>
<span class="kd">const</span> <span class="nx">pennyMoney</span> <span class="o">=</span> <span class="nx">formatMoney</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span> <span class="c1">// å•ä½æ˜¯åˆ†</span>
<span class="nx">pennyMoney</span><span class="p">(</span><span class="mi">1000000</span><span class="p">);</span> <span class="c1">// 10,000.00</span>
<span class="nx">pennyMoney</span><span class="p">(</span><span class="mi">123456</span><span class="p">);</span> <span class="c1">// 1,234.56</span>

<span class="kd">const</span> <span class="nx">dimeMoney</span> <span class="o">=</span> <span class="nx">formatMoney</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="c1">// å•ä½æ˜¯è§’</span>
<span class="nx">dimeMoney</span><span class="p">(</span><span class="mi">1000000</span><span class="p">);</span> <span class="c1">// 100,000.00</span>
<span class="nx">dimeMoney</span><span class="p">(</span><span class="mi">123456</span><span class="p">);</span> <span class="c1">// 12,345.60</span>

<span class="nx">formatMoney</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">1000000</span><span class="p">);</span> <span class="c1">// 1,000,000; // å…ƒ</span>
</code></pre></div></div>

<p>æˆ‘ä»¬é€šè¿‡æŸ¯é‡ŒåŒ–çš„æ–¹å¼é¢„å…ˆä¼ å…¥å•ä½ï¼Œè¿”å›ä¸€ä¸ªé’ˆå¯¹è¯¥å•ä½çš„æ ¼å¼åŒ–æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½åœ¨ä¸åŒçš„æƒ…å†µä¸‹åŠ ä»¥å¤ç”¨ï¼Œå…¶ä¸­ <code class="language-plaintext highlighter-rouge">pennyMoney</code> ä¸ <code class="language-plaintext highlighter-rouge">dimeMoney</code> ä¹Ÿèƒ½åŠ ä»¥å¤ç”¨ï¼Œä¸ç”¨åœ¨æ¯æ¬¡éƒ½ä¼ å…¥è¦é€šè¿‡ä»€ä¹ˆå•ä½æ¥æ ¼å¼åŒ–ã€‚</p>

<h2 id="é«˜é˜¶å‡½æ•°">é«˜é˜¶å‡½æ•°</h2>

<blockquote>
  <p>é«˜é˜¶å‡½æ•°å¯ä»¥æŠŠå…¶ä»–å‡½æ•°ä½œä¸ºå‚æ•°è¾“å…¥æˆ–è€…ä½œä¸ºå…¶è¿”å›å€¼è¾“å‡ºã€‚</p>
</blockquote>

<p>åŸç”Ÿçš„æ–¹æ³•æœ‰å¾ˆå¤šéƒ½æ˜¯é«˜é˜¶å‡½æ•°ï¼Œä¾‹å¦‚ <code class="language-plaintext highlighter-rouge">Array.prototype.map</code> æ–¹æ³•ï¼Œä»–æ¥æ”¶ä¸€å›è°ƒå‡½æ•°ï¼Œä»å›è°ƒå‡½æ•°ä¸­è·å–è¿”å›å€¼ï¼Œå†ä½¿ç”¨è¿™äº›å€¼åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„å¹¶è¿”å›ã€‚</p>

<h3 id="é«˜é˜¶å‡½æ•°çš„åº”ç”¨">é«˜é˜¶å‡½æ•°çš„åº”ç”¨</h3>

<p>ä¸Šè¿°æˆ‘ä»¬é€šè¿‡æŸ¯é‡ŒåŒ–çš„æ–¹å¼ä¼˜åŒ–äº†æ ¼å¼é‡‘é¢çš„æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°æŸ¯é‡ŒåŒ–çš„æ–¹å¼ä¹Ÿä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œä»–ä¹Ÿæ˜¯é«˜é˜¶å‡½æ•°ã€‚ä¸‹é¢æˆ‘ä»¬å°†å†è‡ªå®šä¹‰ä¸€äº›é«˜é˜¶å‡½æ•°ï¼Œè®©æˆ‘ä»¬æ›´åŠ ç†è§£é«˜é˜¶å‡½æ•°çš„åº”ç”¨ã€‚</p>

<h4 id="-é˜²æŠ–å‡½æ•°">ğŸŒ° é˜²æŠ–å‡½æ•°</h4>

<p>æˆ‘æœ‰ä¸€ä¸ªæ–¹æ³•ä¼šæ ¹æ®çª—å£å¤§å°è¿›è¡ŒåŠ¨æ€åŠ è½½å¯¹åº”çš„ç»„ä»¶ï¼Œæ—¢ç„¶éœ€è¦åŠ¨æ€åŠ è½½ç»„ä»¶é‚£ä¹ˆèµ„æºçš„è¯·æ±‚ä»¥åŠç»„ä»¶çš„æ¸²æŸ“è‚¯å®šæ˜¯å¯¹ç½‘ç»œã€å†…å­˜ç­‰æ¶ˆè€—è¦å¤§ä¸€äº›çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œä¸€ä¸ª<strong>é˜²æŠ–</strong>æ“ä½œï¼Œè®©çª—å£å¤§å°å‘ç”Ÿå˜åŒ–æ—¶æ²¡å¿…è¦è¦é‚£ä¹ˆå®æ—¶å˜åŒ–ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">debounce</span> <span class="o">=</span> <span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">wait</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">timer</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">return</span> <span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timer</span><span class="p">);</span>
    <span class="nx">timer</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">func</span><span class="p">(...</span><span class="nx">args</span><span class="p">);</span>
    <span class="p">},</span> <span class="nx">wait</span><span class="p">);</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span>
  <span class="dl">"</span><span class="s2">resize</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">debounce</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">matchMedia</span><span class="p">(</span><span class="dl">"</span><span class="s2">(min-width:768px)</span><span class="dl">"</span><span class="p">))</span> <span class="p">{</span>
      <span class="c1">// loader component</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">resize</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">},</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<p>ä¸Šè¿°ä»£ç å®ç°äº†ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">debounce</code> å‡½æ•°ï¼Œå°†æ¥æ”¶ä¸€ä¸ªå‡½æ•°å’Œä¸€ä¸ªç­‰å¾…æ—¶é—´ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå‡½æ•°æ‰§è¡Œæ—¶ä¼šåšä¸€ä¸ªå»¶æ—¶é˜²æŠ–çš„æ“ä½œã€‚è¿™æ ·åœ¨çª—å£é¢‘ç¹çš„ <code class="language-plaintext highlighter-rouge">resize</code> æ—¶çŸ­æ—¶é—´å†…ä¹Ÿä¸ä¼šå¤šæ¬¡è§¦å‘åŠ è½½ç»„ä»¶çš„æ–¹æ³•ã€‚å½“ç„¶è¯¥é˜²æŠ–å‡½æ•°è¿˜èƒ½åº”ç”¨äºå…¶ä»–å¾ˆå¤šåœºæ™¯ã€‚</p>

<h4 id="-ç»„åˆ-compose">ğŸŒ° ç»„åˆ compose</h4>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">compose</span> <span class="o">=</span>
  <span class="p">(...</span><span class="nx">funcs</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="p">(</span><span class="nx">arg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">funcs</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">val</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">f</span><span class="p">(</span><span class="nx">val</span><span class="p">),</span> <span class="nx">arg</span><span class="p">);</span>
  <span class="p">};</span>
</code></pre></div></div>

<p>è¿™æ˜¯ä¸€ä¸ªå¾ˆç»å…¸çš„é«˜é˜¶å‡½æ•°ï¼Œä»–æ¥æ”¶å¤šä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›çš„è¿™ä¸ªå‡½æ•°å‘¢ä¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°ã€‚é‚£ä»–çš„ä½œç”¨æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¯ä»¥æ‰§è¡Œä»¥ä¸‹ä»£ç çœ‹çœ‹ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">compose</span> <span class="o">=</span>
  <span class="p">(...</span><span class="nx">funcs</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="p">(</span><span class="nx">arg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">funcs</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">val</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">f</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">},</span> <span class="nx">arg</span><span class="p">);</span>
  <span class="p">};</span>

<span class="kd">const</span> <span class="nx">pennyTransform</span> <span class="o">=</span> <span class="p">(</span><span class="nx">money</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">money</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">fixedMoney</span> <span class="o">=</span> <span class="p">(</span><span class="nx">money</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="o">+</span><span class="nx">money</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">thousandthMoney</span> <span class="o">=</span> <span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">.</span><span class="dl">"</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">index</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">\B(?=(?:\d{3})</span><span class="sr">+$</span><span class="se">)</span><span class="sr">/g</span><span class="p">,</span> <span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">start</span> <span class="o">+</span> <span class="nx">str</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">formatMoney</span> <span class="o">=</span> <span class="nx">compose</span><span class="p">(</span><span class="nx">pennyTransform</span><span class="p">,</span> <span class="nx">fixedMoney</span><span class="p">,</span> <span class="nx">thousandthMoney</span><span class="p">);</span>
<span class="nx">formatMoney</span><span class="p">(</span><span class="mi">1000000</span><span class="p">);</span>

<span class="c1">// 10000</span>
<span class="c1">// 10000.00</span>
<span class="c1">// 10,000.00</span>
</code></pre></div></div>

<p>ä¸Šè¿°ä»£ç ä¾æ—§æ˜¯æ ¼å¼åŒ–é‡‘é¢ï¼Œåªä¸è¿‡æ¢äº†ç§å†™æ³•ã€‚æˆ‘ä»¬å¯ä»¥ä»è¾“å‡ºçš„ log ä¸­çœ‹å‡ºï¼Œæˆ‘ä»¬çš„æ–¹æ³• <code class="language-plaintext highlighter-rouge">compose</code> æ˜¯æŠŠæ‰€æœ‰çš„æ–¹æ³•è¿›è¡Œä¸€ä¸ªç»„åˆï¼Œä¾æ¬¡è°ƒç”¨ï¼Œå°†ä¸Šä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ä¼ å…¥ç»™ä¸‹ä¸€ä¸ªå‚æ•°ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè°ƒç”¨æ—¶ä¼ çš„å‚æ•°ï¼‰ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†å‡½æ•°åŠŸèƒ½æ‹†åˆ†çš„å¾ˆç»†ï¼Œä¸€ä¸ªåªåšä¸€ä»¶äº‹ï¼Œæ¯ä¸ªéƒ½æ˜¯çº¯å‡½æ•°ï¼Œæ¯ä¸€ä¸ªå¾ˆå°çš„åŠŸèƒ½å°±æ˜¯ä¸€ä¸ªç²’å­ï¼Œæˆ‘ä»¬å¯ä»¥éšæ„å°†å…¶ç»„åˆæ‹†åˆ†ï¼Œä½¿å…¶åº”ç”¨åœºæ™¯æ›´å¹¿æ³›ã€‚</p>

<p>å¾ˆå¤šåŒå­¦æˆ–è®¸æä¸æ‡‚ <code class="language-plaintext highlighter-rouge">compose</code> è¿™ä¸ªå‡½æ•°å…·ä½“çš„é€»è¾‘ï¼Œæ¥ä¸‹æ¥å°±ä»”ç»†è®²ä¸€è®²ã€‚å¯ä»¥åœ¨ä»£ç ä¸­çœ‹åˆ°æœ€é‡è¦çš„ <code class="language-plaintext highlighter-rouge">reduce</code> è¿™ä¸ªå‡½æ•°ï¼Œè¿™æ˜¯æ•°ç»„åŸç”Ÿçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥å…ˆçœ‹çœ‹ MDN ä¸Šå¯¹è¿™ä¸ªæ–¹æ³•çš„æè¿° <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce">
Array.prototype.reduce</a>ï¼šæ–¹æ³•ä¼šå¯¹æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ æ‰§è¡Œä¼ å…¥çš„å‡½æ•°ï¼Œå†å°†å…¶æ±‡æ€»ç»“æœè¿”å›ã€‚</p>

<p><strong>æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š</strong></p>

<p><code class="language-plaintext highlighter-rouge">callback</code> æ‰§è¡Œæ•°ç»„ä¸­æ¯ä¸ªå€¼ï¼Œæ­¤å‡½æ•°ä¼šæ¥æ”¶å››ä¸ªå‚æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬åªçœ‹ç”¨åˆ°çš„å‰ä¸¤ä¸ªå‚æ•°ï¼š</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">accumulator</code> ç´¯è®¡å™¨ç´¯è®¡å›è°ƒçš„è¿”å›å€¼ï¼Œç®€å•ç†è§£å°±æ˜¯ä¸Šä¸€ä¸ªè°ƒç”¨å›è°ƒå‡½æ•°çš„è¿”å›å€¼ã€‚å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªæ¬¡è°ƒç”¨é‚£ä¹ˆå°±æ˜¯ä¸‹é¢çš„ <code class="language-plaintext highlighter-rouge">initialValue</code> æˆ–è€… <code class="language-plaintext highlighter-rouge">undefined</code>ã€‚</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">currentValue</code> æ•°ç»„ä¸­å½“å‰æ­£åœ¨å¤„ç†çš„å…ƒç´ ã€‚æˆ‘ä»¬æ•°ç»„å†…çš„å…ƒç´ éƒ½æ˜¯æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œå°†æ˜¯å½“å‰éœ€è¦æ‰§è¡Œçš„æ–¹æ³•ã€‚</p>
  </li>
</ul>

<p><code class="language-plaintext highlighter-rouge">initialValue</code> ç¬¬ä¸€æ¬¡è°ƒç”¨å›è°ƒå‡½æ•°ä¼ çš„å€¼ã€‚</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">compose</span> <span class="o">=</span>
  <span class="p">(...</span><span class="nx">funcs</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="p">(</span><span class="nx">initialValue</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">funcs</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">accumulator</span><span class="p">,</span> <span class="nx">currentValue</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">// ç¬¬ä¸€æ¬¡æ‰§è¡Œ accumulator ä¸ºä¼ å…¥çš„ initialValue</span>

      <span class="c1">// å°† accumulator ä¼ å…¥ currentValueï¼ˆå½“å‰éœ€è¦æ‰§è¡Œçš„æ–¹æ³•ï¼‰ï¼Œ</span>
      <span class="c1">// è¿™é‡Œä¹Ÿä¼šå°†å‡½æ•°è°ƒç”¨çš„ç»“æœè¿›è¡Œç«‹å³è¿”å›ï¼Œè¿”å›çš„å€¼å°†ä¼šåœ¨æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªå‡½æ•°æ—¶å½“ accumulator ä½¿ç”¨</span>
      <span class="c1">// ä¸€ç›´åˆ°æ‰§è¡Œå®Œæœ€åä¸€ä¸ªå‡½æ•°ï¼Œå°†æœ€åä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼è¿›è¡Œè¿”å›ã€‚</span>
      <span class="k">return</span> <span class="nx">currentValue</span><span class="p">(</span><span class="nx">accumulator</span><span class="p">);</span>
    <span class="p">},</span> <span class="nx">initialValue</span><span class="p">);</span>
  <span class="p">};</span>
</code></pre></div></div>

<p>è¿™é‡Œå¤§è‡´è®²äº†è®²å‡½æ•°çš„æ‰§è¡Œæµç¨‹ï¼Œæ–¹ä¾¿ç†è§£ï¼Œæœ‰é—®é¢˜æ¬¢è¿è¯„è®ºåŒºç•™è¨€ï¼Œæœ‰é”™è¯¯æ¬¢è¿æŒ‡æ­£ã€‚</p>

<p><strong>å‚è€ƒ</strong></p>

<ul>
  <li><a href="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/">å‡½æ•°å¼ç¼–ç¨‹æŒ‡åŒ—</a></li>
  <li><a href="https://en.wikipedia.org/wiki/First-class_citizen">First-class citizen</a></li>
  <li><a href="https://en.wikipedia.org/wiki/First-class_function">First-class function</a></li>
</ul>

<h2 id="æœ€å">æœ€å</h2>

<p>åŸæœ¬æ‰“ç®—é¡ºå¸¦æŠŠé«˜é˜¶ç»„ä»¶å†™ä¸€å†™ï¼Œæƒ³ä¸€æƒ³è¿˜æ˜¯æ”¾åˆ°ä¸‹ä¸€ä¸ªæ–‡ç« é‡Œé¢å§ï¼Œæ‰“ç®—å†™ä¸€å†™ React çš„é«˜é˜¶ç»„ä»¶ä¸è‡ªå®šä¹‰ Hookã€‚</p>

<p>2020.8.25 æ›´æ–° <a href="https://juejin.im/post/6864871906567749645">åœ¨ React ä¸­è‡ªå®šä¹‰ Hooks çš„åº”ç”¨åœºæ™¯</a></p>

        <div class="date">å‘å¸ƒæ—¶é—´ï¼š2020-07-05</div>
        <div class="ad">
          <script async
            src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4613132254509352"
            crossorigin="anonymous"></script>
          <ins class="adsbygoogle" style="display:block;" data-ad-client="ca-pub-4613132254509352"
            data-ad-slot="8065948199" data-ad-format="horizontal" data-full-width-responsive="true"></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </div>
      <div id="comment">
        <div id="disqus_thread"></div>
<script>
  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
  /*
  var disqus_config = function () {
  this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
  this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
  };
  */
  (function () { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://jaceyi.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>

      </div>
    </div>
    <div class="nav-container">
      <div class="main-nav">
        <div class="nav-card">
          <div class="title">ç›®å½•</div>
          <div class="nav-content"></div>
        </div>
      </div>
    </div>
  </div>
  <footer id="footer">
  <a title="Github" href="https://github.com/jaceyi">
    <i class="iconfont">&#xe600;</i>
  </a>
  <a title="æ˜é‡‘" href="https://juejin.im/user/5a3b2016f265da43231b22a7">
    <i class="iconfont">&#xe610;</i>
  </a>
  <a title="ä¸ªäººç½‘ç«™" href="https://jaceyi.com/">
    <i class="iconfont">&#xe789;</i>
  </a>
  <a title="Twitter" href="https://twitter.com/jaceyi123">
    <i class="iconfont">&#xe602;</i>
  </a>
</footer>

  <div class="back-top">
  <i class="iconfont">&#xe6d9;</i>
</div>
<script>
  (function (d, w) {
    function scrollTo(targetY) {
      var currentY =
        d.documentElement.scrollTop || d.body.scrollTop;
      var distance = (currentY - targetY) / 10;

      function animate() {
        var currentY =
          d.documentElement.scrollTop || d.body.scrollTop;
        var top = currentY - distance;
        top = top < 0 ? 0 : top;
        w.scrollTo(0, top);
        if (top === 0) return;
        w.requestAnimationFrame(animate);
      }

      animate();
    }
    var $upTop = d.querySelector('.back-top');

    $upTop.onclick = function () {
      scrollTo(0);
    };

    function bindEvent() {
      var scrollTop = d.documentElement.scrollTop || d.body.scrollTop;
      if (scrollTop > 100) {
        $upTop.style.display = 'block';
      } else {
        $upTop.style.display = 'none';
      }
    }

    w.addEventListener('scroll', bindEvent);
    w.addEventListener('load', bindEvent);
  })(document, window);
</script>

  <script src="/js/prism.js"></script>
  <script>
    (function (w, d) {
      var $nav = document.querySelector('.main-nav');
      var $navContent = document.querySelector('.nav-content');
      var $article = document.querySelector('.article');
      var titleNodeNames = ['H1', 'H2', 'H3', 'H4', 'H5', 'H6'];
      var contentItems = [];
      var navItems = [];
      for (var i = 0; i < $article.children.length; i++) {
        var element = $article.children[i];
        if (titleNodeNames.includes(element.nodeName)) {
          var link = document.createElement('a');
          link.href = '#' + element.innerText;
          link.innerText = element.innerText;
          link.setAttribute('data-head', element.nodeName)

          $navContent.appendChild(link);
          navItems.push(link);
          element.id = element.innerText;
          contentItems.push(element);
        }
      }

      function bindEvent() {
        var scrollTop = d.documentElement.scrollTop || d.body.scrollTop;
        for (var i = 0; i < navItems.length; i++) {
          removeClass(navItems[i], 'active');
        }
        for (var i = contentItems.length - 1; i >= 0; i--) {
          if (scrollTop >= getElementTop(contentItems[i])) {
            addClass(navItems[i], 'active');
            return;
          }
        }
        addClass(navItems[0], 'active');
      }
      w.addEventListener('scroll', bindEvent);
      w.addEventListener('load', bindEvent);
    })(window, document)
  </script>
</body>

</html>
